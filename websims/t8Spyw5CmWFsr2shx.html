<html><head><base href="." /><title>ULAYAMANOTE.TOKYO - サイケデリック トレイン ビジュアライザー</title><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><style>
@import url('https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@400;700&display=swap');

body {
    margin: 0;
    padding: 0;
    background: #000;
    color: #0f0;
    font-family: 'M PLUS 1p', sans-serif;
    overflow: hidden;
}

.container {
    position: relative;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(0deg, #000, #111);
}

.train-container {
    position: absolute;
    bottom: 20%;
    width: 100%;
    height: 200px;
    animation: float 3s infinite ease-in-out;
}

.train {
    width: 80%;
    height: 100px;
    margin: 0 auto;
    position: relative;
    display: flex;
    gap: 10px;
}

.carriage {
    flex: 1;
    background: #2d2d2d;
    border: 2px solid #0f0;
    box-shadow: 0 0 20px #0f0;
    animation: glow 2s infinite alternate;
    position: relative;
}

.carriage:first-child:before {
    content: 'JR';
    position: absolute;
    left: 10px;
    top: 10px;
    color: #0f0;
    font-size: 12px;
    font-weight: bold;
}

.carriage:after {
    content: '山手線';
    position: absolute;
    right: 10px;
    top: 10px;
    color: #0f0;
    font-size: 12px;
}

.window {
    position: absolute;
    width: 40px;
    height: 30px;
    background: #000;
    border: 2px solid #0f0;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
}

.connector {
    width: 10px;
    background: #0f0;
    height: 20px;
    position: absolute;
    right: -12px;
    top: 40px;
    z-index: 2;
}

.location-marker {
    position: absolute;
    width: 20px;
    height: 20px;
    background: #f00;
    border-radius: 50%;
    animation: pulse 1s infinite;
    z-index: 100;
    top: 40px;
}

.track {
    position: absolute;
    bottom: 15%;
    width: 100%;
    height: 10px;
    background: repeating-linear-gradient(
        90deg,
        #0f0 0px,
        #0f0 20px,
        transparent 20px,
        transparent 40px
    );
    animation: trackMove 10s infinite linear;
}

.effects {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 30% 30%, rgba(255,0,255,0.1) 0%, transparent 50%),
        radial-gradient(circle at 70% 70%, rgba(0,255,255,0.1) 0%, transparent 50%);
    mix-blend-mode: screen;
    animation: effectShift 8s infinite alternate;
}

.station-name {
    position: absolute;
    top: 20px;
    width: 100%;
    text-align: center;
    font-size: 24px;
    color: #0f0;
    text-shadow: 0 0 10px #0f0;
    animation: blink 1s infinite;
    font-family: 'M PLUS 1p', sans-serif;
}

.station-name .ja {
    font-size: 32px;
    display: block;
    margin-bottom: 5px;
}

.station-name .en {
    font-size: 18px;
    opacity: 0.8;
}

.grid {
    position: absolute;
    width: 100%;
    height: 100%;
    background: 
        linear-gradient(transparent 0%, rgba(0,255,0,0.2) 2%, transparent 5%),
        linear-gradient(90deg, transparent 0%, rgba(0,255,0,0.2) 2%, transparent 5%);
    background-size: 50px 50px;
    animation: gridMove 20s infinite linear;
}

.announcement {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.9);
    padding: 20px;
    border: 2px solid #0f0;
    z-index: 1000;
    text-align: center;
    width: 80%;
    max-width: 600px;
    box-shadow: 0 0 20px #0f0;
    animation: glitch 1s infinite;
}

.announcement-text {
    font-size: 18px;
    line-height: 1.5;
    margin: 0;
}

.announcement-text .ja {
    display: block;
    font-size: 24px;
    margin-bottom: 10px;
}

.play-button {
    position: fixed;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    background: #000;
    border: 2px solid #0f0;
    color: #0f0;
    padding: 15px 30px;
    font-family: 'M PLUS 1p', sans-serif;
    font-size: 18px;
    cursor: pointer;
    z-index: 1000;
    box-shadow: 0 0 20px #0f0;
    transition: all 0.3s ease;
}

.play-button:hover {
    background: #0f0;
    color: #000;
}

.play-button::before {
    content: '▶';
    margin-right: 10px;
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

@keyframes glow {
    0% { box-shadow: 0 0 20px #0f0; }
    100% { box-shadow: 0 0 40px #0f0; }
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.5; }
    100% { transform: scale(1); opacity: 1; }
}

@keyframes trackMove {
    0% { background-position: 0 0; }
    100% { background-position: -800px 0; }
}

@keyframes effectShift {
    0% { transform: scale(1) rotate(0deg); }
    100% { transform: scale(1.2) rotate(10deg); }
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

@keyframes gridMove {
    0% { transform: translateY(0); }
    100% { transform: translateY(1000px); }
}

@keyframes glitch {
    0% { transform: translate(-50%, -50%) skew(0deg); }
    20% { transform: translate(-50%, -50%) skew(10deg); }
    40% { transform: translate(-50%, -50%) skew(-10deg); }
    60% { transform: translate(-50%, -50%) skew(5deg); }
    80% { transform: translate(-50%, -50%) skew(-5deg); }
    100% { transform: translate(-50%, -50%) skew(0deg); }
}
</style></head><body>
<div class="container">
    <div class="grid"></div>
    <div class="effects"></div>
    <div class="station-name">
        <span class="ja">渋谷</span>
        <span class="en">SHIBUYA</span>
    </div>
    <div class="announcement">
        <p class="announcement-text">
            <span class="ja">システムアラート:<br>ULA山手線<br>トラフィッククラブ東京<br>六本木にて開催</span>
            <span class="en">SYSTEM ALERT:<br>ULA YAMANOTE<br>LAUNCHING AT<br>TRAFFIC CLUB TOKYO<br>ROPPONGI<br>2024</span>
        </p>
    </div>
    <div class="train-container">
        <div class="train">
            <div class="carriage">
                <div class="window"></div>
                <div class="connector"></div>
            </div>
            <div class="carriage">
                <div class="window"></div>
                <div class="connector"></div>
            </div>
            <div class="carriage">
                <div class="window"></div>
                <div class="connector"></div>
            </div>
            <div class="carriage">
                <div class="window"></div>
                <div class="connector"></div>
            </div>
            <div class="carriage">
                <div class="window"></div>
                <div class="location-marker" id="userLocation"></div>
            </div>
        </div>
    </div>
    <div class="track"></div>
    <button class="play-button">山手線サウンド</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
<script>
const stations = [
    {ja: "渋谷", en: "Shibuya"},
    {ja: "原宿", en: "Harajuku"},
    {ja: "代々木", en: "Yoyogi"},
    {ja: "新宿", en: "Shinjuku"},
    {ja: "新大久保", en: "Shin-Ōkubo"},
    {ja: "高田馬場", en: "Takadanobaba"},
    {ja: "目白", en: "Mejiro"},
    {ja: "池袋", en: "Ikebukuro"},
    {ja: "大塚", en: "Ōtsuka"},
    {ja: "巣鴨", en: "Sugamo"},
    {ja: "駒込", en: "Komagome"},
    {ja: "田端", en: "Tabata"},
    {ja: "西日暮里", en: "Nishi-Nippori"},
    {ja: "日暮里", en: "Nippori"},
    {ja: "鶯谷", en: "Uguisudani"},
    {ja: "上野", en: "Ueno"},
    {ja: "御徒町", en: "Okachimachi"},
    {ja: "秋葉原", en: "Akihabara"},
    {ja: "神田", en: "Kanda"},
    {ja: "東京", en: "Tokyo"},
    {ja: "有楽町", en: "Yūrakuchō"},
    {ja: "新橋", en: "Shinbashi"},
    {ja: "浜松町", en: "Hamamatsuchō"},
    {ja: "田町", en: "Tamachi"},
    {ja: "品川", en: "Shinagawa"},
    {ja: "大崎", en: "Ōsaki"},
    {ja: "五反田", en: "Gotanda"},
    {ja: "目黒", en: "Meguro"},
    {ja: "恵比寿", en: "Ebisu"}
];

let currentStationIndex = 0;
const stationNameElement = document.querySelector('.station-name');
const announcement = document.querySelector('.announcement');

// Audio setup
const audioElement = new Audio('https://github.com/pollinations/ula-yamanote.tokyo/raw/refs/heads/main/convenience%20store%20-%20shabu%20shabu%20-%20please%20be%20careful.mp3');
audioElement.loop = true;

const playButton = document.querySelector('.play-button');
playButton.addEventListener('click', () => {
    if (audioElement.paused) {
        audioElement.play();
        playButton.style.background = '#0f0';
        playButton.style.color = '#000';
    } else {
        audioElement.pause();
        playButton.style.background = '#000';
        playButton.style.color = '#0f0';
    }
});

// Add glitch effect to announcement text
setInterval(() => {
    const text = announcement.querySelector('.announcement-text');
    if (Math.random() > 0.9) {
        text.style.transform = `skew(${Math.random() * 10 - 5}deg)`;
        text.style.textShadow = `${Math.random() * 10 - 5}px ${Math.random() * 10 - 5}px #f0f`;
        setTimeout(() => {
            text.style.transform = 'skew(0deg)';
            text.style.textShadow = 'none';
        }, 100);
    }
}, 100);

// Simulated train movement
setInterval(() => {
    currentStationIndex = (currentStationIndex + 1) % stations.length;
    const station = stations[currentStationIndex];
    stationNameElement.querySelector('.ja').textContent = station.ja;
    stationNameElement.querySelector('.en').textContent = station.en;
}, 5000);

// Rest of the JavaScript remains the same
function updateUserLocation() {
    const currentCarriage = document.querySelector('.carriage:last-child');
    const userLocation = document.getElementById('userLocation');
    const carriageWidth = currentCarriage.offsetWidth;
    const position = (Math.sin(Date.now() / 1000) + 1) / 2;
    userLocation.style.left = `${position * (carriageWidth - 20)}px`;
}

setInterval(updateUserLocation, 50);

const synth = new Tone.Synth().toDestination();
const notes = ['C4', 'E4', 'G4', 'B4', 'D5'];

setInterval(() => {
    if (Math.random() > 0.7) {
        const note = notes[Math.floor(Math.random() * notes.length)];
        synth.triggerAttackRelease(note, '0.1');
    }
}, 500);

if ("geolocation" in navigator) {
    navigator.geolocation.watchPosition((position) => {
        console.log("Location updated:", position.coords.latitude, position.coords.longitude);
    }, (error) => {
        console.error("Error getting location:", error);
    });
}
</script></body></html>